@rendermode InteractiveServer
@using CarInventory.Models

// Search box input for filtering cars by make or model
<input class="form-control mb-3" placeholder="Search cars..." @bind="Term" @bind:event="oninput" />

@code {
    // Parameters passed from the parent component
    [Parameter] public List<Car> Cars { get; set; } = new();
    [Parameter] public EventCallback<List<Car>> ResultsChanged { get; set; }

    // Filters the cars based on the search term and notifies the parent component
    private async Task OnSearchChanged()
    {
        var filtered = Cars
        .Where(c => c.Make.Contains(Term, StringComparison.OrdinalIgnoreCase) ||
        c.Model.Contains(Term, StringComparison.OrdinalIgnoreCase))
        .ToList();

        await ResultsChanged.InvokeAsync(filtered);
    }

    // Stores the current search text
    private string _term = "";

    // Triggers filtering on each keystroke when the search term changes
    private string Term
    {
        get => _term;
        set
        {
            _term = value;
            _ = OnSearchChanged();
        }
    }
}